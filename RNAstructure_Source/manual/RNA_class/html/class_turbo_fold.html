<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>RNAstructure Classes: TurboFold Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>TurboFold Class Reference</h1><!-- doxytag: class="TurboFold" --><a class="el" href="class_turbo_fold.html" title="TurboFold Class.">TurboFold</a> Class.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;TurboFold_object.h&gt;</code>
<p>

<p>
<a href="class_turbo_fold-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#c8751824c64c94b5f3e9bc2e4950844c">TurboFold</a> (const char fasta_fp[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor - user provides a filename for a FASTA file.  <a href="#c8751824c64c94b5f3e9bc2e4950844c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#a02ca8b6556bdc5cb8b8993655b63d8e">TurboFold</a> (vector&lt; string &gt; *sequences, vector&lt; string &gt; *saves)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor - user provides a vector array of strings that provide input and output file names.  <a href="#a02ca8b6556bdc5cb8b8993655b63d8e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#682942ce216dfeea3ed58c6df0a5da59">~TurboFold</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor.  <a href="#682942ce216dfeea3ed58c6df0a5da59"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#59ff1722a43867e11e7de937e4842306">GetErrorCode</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an integer that reports the current error status of the class.  <a href="#59ff1722a43867e11e7de937e4842306"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#b675cb6f21e39d4d96196b2a2d61c92d">GetErrorMessage</a> (int err_code)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return error messages based on code from GetErrorCode or function-returned error codes.  <a href="#b675cb6f21e39d4d96196b2a2d61c92d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#9696707c382e98711c727922544d319b">GetErrorString</a> (int err_code)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return error messages based on code from GetErrorCode and other error codes.  <a href="#9696707c382e98711c727922544d319b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#2bccec807dded7d95f1a8d6a54ac3845">SetMaxPairingDistance</a> (int distance)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set a maximum distance between nucleotides that can pair.  <a href="#2bccec807dded7d95f1a8d6a54ac3845"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#53087b772ad9219719002edd0d633791">ReadSHAPE</a> (const int i_seq, const char fp[], const double par1, const double par2)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read and apply SHAPE mapping data to a specific sequence.  <a href="#53087b772ad9219719002edd0d633791"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#43d9e9896cff38460d901f352b60b8cf">SetTemperature</a> (double temp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the folding temperature.  <a href="#43d9e9896cff38460d901f352b60b8cf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#bfa526c984726abacc49d5cb068922a6">fold</a> (double gamma=0.3, int n_iterations=3, int _n_parallel_pfunctions=1)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The main <a class="el" href="class_turbo_fold.html" title="TurboFold Class.">TurboFold</a> algorithm.  <a href="#bfa526c984726abacc49d5cb068922a6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#67506057fe16f65037e06f585f57a63a">ProbKnot</a> (const int i_seq, const int n_iterations, const int minhelixlength)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Use the ProbKnot algorithm to predict a structure for a sequence.  <a href="#67506057fe16f65037e06f585f57a63a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#c203865ca75a88a9efb6576b1ba6c5d1">PredictProbablePairs</a> (const int i_seq, const float probability)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Predict a structure for a sequence that is composed of highly probably pairs.  <a href="#c203865ca75a88a9efb6576b1ba6c5d1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#ce93e3b8fcf065857efaf599e0edcee4">MaximizeExpectedAccuracy</a> (const int i_seq, const double maxPercent, const int maxStructures, const int window, const double gamma=1.0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Predict maximum expected accuracy structures for a sequence.  <a href="#ce93e3b8fcf065857efaf599e0edcee4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#a34e1b92e05a143712c4a832bbfb055a">GetPair</a> (const int i_seq, const int i, const int structurenumber=1)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provide pairing information.  <a href="#a34e1b92e05a143712c4a832bbfb055a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#515b27fc16c9addb2e1b573222e44c0a">GetPairProbability</a> (const int i_seq, const int i, const int j)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provide pairing probability information.  <a href="#515b27fc16c9addb2e1b573222e44c0a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#3368808475828ddaa328493eae48173e">GetNumberSequences</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provide the number of sequences used in the calculation.  <a href="#3368808475828ddaa328493eae48173e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#2f15a077b6501f7b3dad004efa0ccaa9">WriteCt</a> (const int i_seq, const char fp[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the predicted structures for a specific sequence to a ct file.  <a href="#2f15a077b6501f7b3dad004efa0ccaa9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#3947f69f2c652d4942363484f52cc846">SetProgress</a> (TProgressDialog &amp;Progress)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_turbo_fold.html#456017f6eb435cfd1d8b152e3bbca767">StopProgress</a> ()</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<a class="el" href="class_turbo_fold.html" title="TurboFold Class.">TurboFold</a> Class. 
<p>
The <a class="el" href="class_turbo_fold.html" title="TurboFold Class.">TurboFold</a> class provides an entry point for the <a class="el" href="class_turbo_fold.html" title="TurboFold Class.">TurboFold</a> algorithm in RNAstructure. <hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="c8751824c64c94b5f3e9bc2e4950844c"></a><!-- doxytag: member="TurboFold::TurboFold" ref="c8751824c64c94b5f3e9bc2e4950844c" args="(const char fasta_fp[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TurboFold::TurboFold           </td>
          <td>(</td>
          <td class="paramtype">const char&nbsp;</td>
          <td class="paramname"> <em>fasta_fp</em>[]          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor - user provides a filename for a FASTA file. 
<p>
Input file should contain two or more FASTA sequences. The constructor reads parameter files from disk. The location should be specified in the DATAPATH environment variable. If DATAPATH is undefined, the program will attempt to load the files from the present working directory. This constructor generates internal error codes that can be accessed by <a class="el" href="class_turbo_fold.html#59ff1722a43867e11e7de937e4842306" title="Get an integer that reports the current error status of the class.">GetErrorCode()</a> after the constructor is called. 0 = no error. The errorcode can be resolved to a c string using GetErrorMessage. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fasta_fp</em>&nbsp;</td><td>is a NULL terminated c string that give a filename. This must be 1000 or fewer characters. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="a02ca8b6556bdc5cb8b8993655b63d8e"></a><!-- doxytag: member="TurboFold::TurboFold" ref="a02ca8b6556bdc5cb8b8993655b63d8e" args="(vector&lt; string &gt; *sequences, vector&lt; string &gt; *saves)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TurboFold::TurboFold           </td>
          <td>(</td>
          <td class="paramtype">vector&lt; string &gt; *&nbsp;</td>
          <td class="paramname"> <em>sequences</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; string &gt; *&nbsp;</td>
          <td class="paramname"> <em>saves</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor - user provides a vector array of strings that provide input and output file names. 
<p>
The output files are partition function save files, which can be read by the <a class="el" href="class_r_n_a.html" title="RNA Class.">RNA</a> class to determine ppair probabilities. There needs to be one output file per input sequence. The constructor reads parameter files from disk. The location should be specified in the DATAPATH environment variable. If DATAPATH is undefined, the program will attempt to load the files from the present working directory. This constructor generates internal error codes that can be accessed by <a class="el" href="class_turbo_fold.html#59ff1722a43867e11e7de937e4842306" title="Get an integer that reports the current error status of the class.">GetErrorCode()</a> after the constructor is called. 0 = no error. The errorcode can be resolved to a c string using GetErrorMessage. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sequences</em>&nbsp;</td><td>is a vector of strings that provide sequence file names. These files need to be either FASTA or .seq. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>saves</em>&nbsp;</td><td>is a vector of strings that provide file names for output partition function save files. This array needs to have exactly the same number of elements as sequences. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="682942ce216dfeea3ed58c6df0a5da59"></a><!-- doxytag: member="TurboFold::~TurboFold" ref="682942ce216dfeea3ed58c6df0a5da59" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TurboFold::~TurboFold           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destructor. 
<p>

<p>
this-&gt;aln_mapping_probs[i_seq1][i_seq2][i] = (double*)malloc(sizeof(double) * (max_k - min_k + 2)); 
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="bfa526c984726abacc49d5cb068922a6"></a><!-- doxytag: member="TurboFold::fold" ref="bfa526c984726abacc49d5cb068922a6" args="(double gamma=0.3, int n_iterations=3, int _n_parallel_pfunctions=1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::fold           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>gamma</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n_iterations</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>_n_parallel_pfunctions</em> = <code>1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The main <a class="el" href="class_turbo_fold.html" title="TurboFold Class.">TurboFold</a> algorithm. 
<p>
This function accomplishes the task of determining the pair probabilities. This function must be called before any of the structure prediction methods can be used. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>gamma</em>&nbsp;</td><td>is the weight of the extrinsic information. Larger gamma will result in more consistent structures. The default is 0.3 and this provided a good structure prediction accuracy in benchmarks. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>n_iterations</em>&nbsp;</td><td>is the number of iterations that should be performed to converge the base pairing probabilities. The default is 3 because benchmarks showed only marginal improvement with further iterations. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_n_parallel_pfunctions</em>&nbsp;</td><td>is the number of threads to use. For code compiled in serial, this must be 1, which is the default. Define COMPILE_SMP to build for multithreading. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An integer error code that can be resolved to an error message using <a class="el" href="class_turbo_fold.html#b675cb6f21e39d4d96196b2a2d61c92d" title="Return error messages based on code from GetErrorCode or function-returned error...">GetErrorMessage()</a> or <a class="el" href="class_turbo_fold.html#9696707c382e98711c727922544d319b" title="Return error messages based on code from GetErrorCode and other error codes.">GetErrorString()</a>. 0 is no error. </dd></dl>

</div>
</div><p>
<a class="anchor" name="59ff1722a43867e11e7de937e4842306"></a><!-- doxytag: member="TurboFold::GetErrorCode" ref="59ff1722a43867e11e7de937e4842306" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::GetErrorCode           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get an integer that reports the current error status of the class. 
<p>
Functions generate internal errors that can be accessed using this function. An error code of zero is no error. A non-zero error code can be resolved to a cstring or string using <a class="el" href="class_turbo_fold.html#b675cb6f21e39d4d96196b2a2d61c92d" title="Return error messages based on code from GetErrorCode or function-returned error...">GetErrorMessage()</a> or <a class="el" href="class_turbo_fold.html#9696707c382e98711c727922544d319b" title="Return error messages based on code from GetErrorCode and other error codes.">GetErrorString()</a>. <dl class="return" compact><dt><b>Returns:</b></dt><dd>An integer that indicates error status. </dd></dl>

</div>
</div><p>
<a class="anchor" name="b675cb6f21e39d4d96196b2a2d61c92d"></a><!-- doxytag: member="TurboFold::GetErrorMessage" ref="b675cb6f21e39d4d96196b2a2d61c92d" args="(int err_code)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * TurboFold::GetErrorMessage           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>err_code</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return error messages based on code from GetErrorCode or function-returned error codes. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>err_code</em>&nbsp;</td><td>is the integer error code provided by <a class="el" href="class_turbo_fold.html#59ff1722a43867e11e7de937e4842306" title="Get an integer that reports the current error status of the class.">GetErrorCode()</a>. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A pointer to a c string that provides an error message. </dd></dl>

</div>
</div><p>
<a class="anchor" name="9696707c382e98711c727922544d319b"></a><!-- doxytag: member="TurboFold::GetErrorString" ref="9696707c382e98711c727922544d319b" args="(int err_code)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string TurboFold::GetErrorString           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>err_code</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return error messages based on code from GetErrorCode and other error codes. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>err_code</em>&nbsp;</td><td>is the integer error code provided by <a class="el" href="class_turbo_fold.html#59ff1722a43867e11e7de937e4842306" title="Get an integer that reports the current error status of the class.">GetErrorCode()</a> or from other functions that return integer error codes. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A string that provides an error message. </dd></dl>

</div>
</div><p>
<a class="anchor" name="3368808475828ddaa328493eae48173e"></a><!-- doxytag: member="TurboFold::GetNumberSequences" ref="3368808475828ddaa328493eae48173e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::GetNumberSequences           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Provide the number of sequences used in the calculation. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The number of sequences used in the calculation. </dd></dl>

</div>
</div><p>
<a class="anchor" name="a34e1b92e05a143712c4a832bbfb055a"></a><!-- doxytag: member="TurboFold::GetPair" ref="a34e1b92e05a143712c4a832bbfb055a" args="(const int i_seq, const int i, const int structurenumber=1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::GetPair           </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>structurenumber</em> = <code>1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Provide pairing information. 
<p>
This function can only be called after one of the structure prediction methods is a called. This function generates internal error codes that can be accessed by <a class="el" href="class_turbo_fold.html#59ff1722a43867e11e7de937e4842306" title="Get an integer that reports the current error status of the class.">GetErrorCode()</a> after the constructor is called. 0 = no error. The errorcode can be resolved to a c string using GetErrorMessage. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>i_seq</em>&nbsp;</td><td>is the sequence number, where the number starts at 1. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>i</em>&nbsp;</td><td>is the nucleotide. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>structurenumber</em>&nbsp;</td><td>is the structure number. This can be used to specify a suboptimal structure, but defaults to 1. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The nucleotide to which i is paired in sequence i_seq and suboptimal structure number structurenumber. Zero indicates that the nucleotide is unpaired. </dd></dl>

</div>
</div><p>
<a class="anchor" name="515b27fc16c9addb2e1b573222e44c0a"></a><!-- doxytag: member="TurboFold::GetPairProbability" ref="515b27fc16c9addb2e1b573222e44c0a" args="(const int i_seq, const int i, const int j)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TurboFold::GetPairProbability           </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>j</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Provide pairing probability information. 
<p>
This function can only be called after <a class="el" href="class_turbo_fold.html#bfa526c984726abacc49d5cb068922a6" title="The main TurboFold algorithm.">fold()</a> is a called. This function generates internal error codes that can be accessed by <a class="el" href="class_turbo_fold.html#59ff1722a43867e11e7de937e4842306" title="Get an integer that reports the current error status of the class.">GetErrorCode()</a> after the constructor is called. 0 = no error. The errorcode can be resolved to a c string using GetErrorMessage. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>i_seq</em>&nbsp;</td><td>is the sequence number, where the number starts at 1. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>i</em>&nbsp;</td><td>is the 5' nucleotide in a pair. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>j</em>&nbsp;</td><td>is the 3' nucleotide in a pair. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The probability that i is paired to j in sequence i_seq. </dd></dl>

</div>
</div><p>
<a class="anchor" name="ce93e3b8fcf065857efaf599e0edcee4"></a><!-- doxytag: member="TurboFold::MaximizeExpectedAccuracy" ref="ce93e3b8fcf065857efaf599e0edcee4" args="(const int i_seq, const double maxPercent, const int maxStructures, const int window, const double gamma=1.0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::MaximizeExpectedAccuracy           </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>maxPercent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>maxStructures</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>gamma</em> = <code>1.0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Predict maximum expected accuracy structures for a sequence. 
<p>
This function can only be called after <a class="el" href="class_turbo_fold.html#bfa526c984726abacc49d5cb068922a6" title="The main TurboFold algorithm.">fold()</a> is called. The expectd accuracy score for a structure is = gamma * 2 * (sum of pairing probabilities for pairs) + (sum of unpairing probabilities for single stranded nucleotides). <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>i_seq</em>&nbsp;</td><td>is the sequence number, where the number starts at 1. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxPercent</em>&nbsp;</td><td>is the maximum difference in score allowed for generation of suboptimal structures. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxStructures</em>&nbsp;</td><td>is the maximum number of suboptimal structures allowed. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>window</em>&nbsp;</td><td>is the window parameter that controls what suboptimal structures can be included. 0 is the minimum and the higher the window, the more different suboptimal structures must be from each other. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>gamma</em>&nbsp;</td><td>is the weight on base pairs. The default of 1.0 works well based on benchmarks on single sequence calculations. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An integer error code that can be resolved to an error message using <a class="el" href="class_turbo_fold.html#b675cb6f21e39d4d96196b2a2d61c92d" title="Return error messages based on code from GetErrorCode or function-returned error...">GetErrorMessage()</a> or <a class="el" href="class_turbo_fold.html#9696707c382e98711c727922544d319b" title="Return error messages based on code from GetErrorCode and other error codes.">GetErrorString()</a>. 0 is no error. </dd></dl>

</div>
</div><p>
<a class="anchor" name="c203865ca75a88a9efb6576b1ba6c5d1"></a><!-- doxytag: member="TurboFold::PredictProbablePairs" ref="c203865ca75a88a9efb6576b1ba6c5d1" args="(const int i_seq, const float probability)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::PredictProbablePairs           </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&nbsp;</td>
          <td class="paramname"> <em>probability</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Predict a structure for a sequence that is composed of highly probably pairs. 
<p>
This function can only be called after <a class="el" href="class_turbo_fold.html#bfa526c984726abacc49d5cb068922a6" title="The main TurboFold algorithm.">fold()</a> is called. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>i_seq</em>&nbsp;</td><td>is the sequence number, where the number starts at 1. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>probability</em>&nbsp;</td><td>is the pairing probability threshold, where pairs will be predicted if they have a higher probability. Note that a value of less than 0.5 (50%), will cause an error. The default value of zero will trigger the creation of 8 structures, with thresholds of &gt;=0.99, &gt;=0.97, &gt;=0.95, &gt;=0.90, &gt;=0.80, &gt;=0.70, &gt;=0.60, &gt;0.50. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An integer error code that can be resolved to an error message using <a class="el" href="class_turbo_fold.html#b675cb6f21e39d4d96196b2a2d61c92d" title="Return error messages based on code from GetErrorCode or function-returned error...">GetErrorMessage()</a> or <a class="el" href="class_turbo_fold.html#9696707c382e98711c727922544d319b" title="Return error messages based on code from GetErrorCode and other error codes.">GetErrorString()</a>. 0 is no error. </dd></dl>

</div>
</div><p>
<a class="anchor" name="67506057fe16f65037e06f585f57a63a"></a><!-- doxytag: member="TurboFold::ProbKnot" ref="67506057fe16f65037e06f585f57a63a" args="(const int i_seq, const int n_iterations, const int minhelixlength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::ProbKnot           </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>n_iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>minhelixlength</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Use the ProbKnot algorithm to predict a structure for a sequence. 
<p>
This function can predict pseudoknots. This function can only be called after <a class="el" href="class_turbo_fold.html#bfa526c984726abacc49d5cb068922a6" title="The main TurboFold algorithm.">fold()</a> is called. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>i_seq</em>&nbsp;</td><td>is the sequence number, where the number starts at 1. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>n_iterations</em>&nbsp;</td><td>is the number of ProbKnot iterations. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>minhelixlength</em>&nbsp;</td><td>is the length of the shortest helix allowed. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An integer error code that can be resolved to an error message using <a class="el" href="class_turbo_fold.html#b675cb6f21e39d4d96196b2a2d61c92d" title="Return error messages based on code from GetErrorCode or function-returned error...">GetErrorMessage()</a> or <a class="el" href="class_turbo_fold.html#9696707c382e98711c727922544d319b" title="Return error messages based on code from GetErrorCode and other error codes.">GetErrorString()</a>. 0 is no error. </dd></dl>

</div>
</div><p>
<a class="anchor" name="53087b772ad9219719002edd0d633791"></a><!-- doxytag: member="TurboFold::ReadSHAPE" ref="53087b772ad9219719002edd0d633791" args="(const int i_seq, const char fp[], const double par1, const double par2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::ReadSHAPE           </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&nbsp;</td>
          <td class="paramname"> <em>fp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>par1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>par2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read and apply SHAPE mapping data to a specific sequence. 
<p>
The pseudofree energy approach will be used to apply SHAPE data to restrain structure prediction. Where DG(per stack with ith nucleotide) = slope (SHAPE on ith nucleotide) + intercept. This function must be called before <a class="el" href="class_turbo_fold.html#bfa526c984726abacc49d5cb068922a6" title="The main TurboFold algorithm.">fold()</a>. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>i_seq</em>&nbsp;</td><td>is the sequence number to which the restraint should be applied, where the number starts at 1. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fp[]</em>&nbsp;</td><td>is a cstring that provides the name of the file that contains the normalized SHAPE mapping data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>par1</em>&nbsp;</td><td>is the slope in kcal/mol. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>par2</em>&nbsp;</td><td>is the intercept in kcal/mol. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An integer error code that can be resolved to an error message using <a class="el" href="class_turbo_fold.html#b675cb6f21e39d4d96196b2a2d61c92d" title="Return error messages based on code from GetErrorCode or function-returned error...">GetErrorMessage()</a> or <a class="el" href="class_turbo_fold.html#9696707c382e98711c727922544d319b" title="Return error messages based on code from GetErrorCode and other error codes.">GetErrorString()</a>. 0 is no error. </dd></dl>

</div>
</div><p>
<a class="anchor" name="2bccec807dded7d95f1a8d6a54ac3845"></a><!-- doxytag: member="TurboFold::SetMaxPairingDistance" ref="2bccec807dded7d95f1a8d6a54ac3845" args="(int distance)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::SetMaxPairingDistance           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>distance</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set a maximum distance between nucleotides that can pair. 
<p>
This function must be called before <a class="el" href="class_turbo_fold.html#bfa526c984726abacc49d5cb068922a6" title="The main TurboFold algorithm.">fold()</a> and will limit the distance between nucleotides that can pair. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>distance</em>&nbsp;</td><td>is an integer that specifies the maximum distance between nucleotides that can pair, , i.e. |j-i| &lt; distance for nucleotide i to pair to j. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An integer error code that can be resolved to an error message using <a class="el" href="class_turbo_fold.html#b675cb6f21e39d4d96196b2a2d61c92d" title="Return error messages based on code from GetErrorCode or function-returned error...">GetErrorMessage()</a> or <a class="el" href="class_turbo_fold.html#9696707c382e98711c727922544d319b" title="Return error messages based on code from GetErrorCode and other error codes.">GetErrorString()</a>. 0 is no error. </dd></dl>

</div>
</div><p>
<a class="anchor" name="3947f69f2c652d4942363484f52cc846"></a><!-- doxytag: member="TurboFold::SetProgress" ref="3947f69f2c652d4942363484f52cc846" args="(TProgressDialog &amp;Progress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TurboFold::SetProgress           </td>
          <td>(</td>
          <td class="paramtype">TProgressDialog &amp;&nbsp;</td>
          <td class="paramname"> <em>Progress</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Provide a TProgressDialog for following calculation progress. A TProgressDialog class has a public function void update(int percent) that indicates the progress of a long calculation. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Progress</em>&nbsp;</td><td>is a TProgressDialog class. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="43d9e9896cff38460d901f352b60b8cf"></a><!-- doxytag: member="TurboFold::SetTemperature" ref="43d9e9896cff38460d901f352b60b8cf" args="(double temp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::SetTemperature           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>temp</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the folding temperature. 
<p>
This function must be called before <a class="el" href="class_turbo_fold.html#bfa526c984726abacc49d5cb068922a6" title="The main TurboFold algorithm.">fold()</a>. If this function is not called, the default temperature of 310.15 K (37 degrees C) is used. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>temp</em>&nbsp;</td><td>is the temperature in Kelvin. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An integer error code that can be resolved to an error message using <a class="el" href="class_turbo_fold.html#b675cb6f21e39d4d96196b2a2d61c92d" title="Return error messages based on code from GetErrorCode or function-returned error...">GetErrorMessage()</a> or <a class="el" href="class_turbo_fold.html#9696707c382e98711c727922544d319b" title="Return error messages based on code from GetErrorCode and other error codes.">GetErrorString()</a>. 0 is no error. </dd></dl>

</div>
</div><p>
<a class="anchor" name="456017f6eb435cfd1d8b152e3bbca767"></a><!-- doxytag: member="TurboFold::StopProgress" ref="456017f6eb435cfd1d8b152e3bbca767" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TurboFold::StopProgress           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Provide a means to stop using a TProgressDialog. StopProgress tells the <a class="el" href="class_r_n_a.html" title="RNA Class.">RNA</a> class to no longer follow progress. This should be called if the TProgressDialog is deleted, so that this class does not make reference to it. 
</div>
</div><p>
<a class="anchor" name="2f15a077b6501f7b3dad004efa0ccaa9"></a><!-- doxytag: member="TurboFold::WriteCt" ref="2f15a077b6501f7b3dad004efa0ccaa9" args="(const int i_seq, const char fp[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TurboFold::WriteCt           </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&nbsp;</td>
          <td class="paramname"> <em>fp</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the predicted structures for a specific sequence to a ct file. 
<p>
This function can only be called after one of the structure prediction methods is a called. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>i_seq</em>&nbsp;</td><td>is the sequence number, where the number starts at 1. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fp</em>&nbsp;</td><td>is a cstring that gives the filename to which the ct table is to be written. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An integer error code that can be resolved to an error message using <a class="el" href="class_turbo_fold.html#b675cb6f21e39d4d96196b2a2d61c92d" title="Return error messages based on code from GetErrorCode or function-returned error...">GetErrorMessage()</a> or <a class="el" href="class_turbo_fold.html#9696707c382e98711c727922544d319b" title="Return error messages based on code from GetErrorCode and other error codes.">GetErrorString()</a>. 0 is no error. </dd></dl>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>E:/RNAstructure/TurboFold/TurboFold_object.h<li>E:/RNAstructure/TurboFold/TurboFold_object.cpp</ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Sep 7 12:53:49 2011 for RNAstructure Classes by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7.1 </small></address>
</body>
</html>
